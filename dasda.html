<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your Name">
<meta name="dcterms.date" content="2025-12-02">

<title>Pokémon Card Market Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="dasda_files/libs/clipboard/clipboard.min.js"></script>
<script src="dasda_files/libs/quarto-html/quarto.js"></script>
<script src="dasda_files/libs/quarto-html/popper.min.js"></script>
<script src="dasda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dasda_files/libs/quarto-html/anchor.min.js"></script>
<link href="dasda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dasda_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dasda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dasda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dasda_files/libs/bootstrap/bootstrap-32162a2fca7cb0439643f2faaab1edf3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary"><span class="header-section-number">1</span> Executive Summary</a></li>
  <li><a href="#data-loading-cleaning" id="toc-data-loading-cleaning" class="nav-link" data-scroll-target="#data-loading-cleaning"><span class="header-section-number">2</span> Data Loading &amp; Cleaning</a>
  <ul class="collapse">
  <li><a href="#load-all-40-card-files" id="toc-load-all-40-card-files" class="nav-link" data-scroll-target="#load-all-40-card-files"><span class="header-section-number">2.1</span> Load All 40 Card Files</a></li>
  <li><a href="#focus-on-near-mint-condition" id="toc-focus-on-near-mint-condition" class="nav-link" data-scroll-target="#focus-on-near-mint-condition"><span class="header-section-number">2.2</span> Focus on Near Mint Condition</a></li>
  <li><a href="#calculate-returns" id="toc-calculate-returns" class="nav-link" data-scroll-target="#calculate-returns"><span class="header-section-number">2.3</span> Calculate Returns</a></li>
  </ul></li>
  <li><a href="#part-1-does-the-basket-behave-like-a-market-index" id="toc-part-1-does-the-basket-behave-like-a-market-index" class="nav-link" data-scroll-target="#part-1-does-the-basket-behave-like-a-market-index"><span class="header-section-number">3</span> Part 1: Does the Basket Behave Like a Market Index?</a>
  <ul class="collapse">
  <li><a href="#construct-the-basket-index" id="toc-construct-the-basket-index" class="nav-link" data-scroll-target="#construct-the-basket-index"><span class="header-section-number">3.1</span> Construct the Basket Index</a></li>
  <li><a href="#statistical-properties" id="toc-statistical-properties" class="nav-link" data-scroll-target="#statistical-properties"><span class="header-section-number">3.2</span> Statistical Properties</a></li>
  <li><a href="#autocorrelation-analysis" id="toc-autocorrelation-analysis" class="nav-link" data-scroll-target="#autocorrelation-analysis"><span class="header-section-number">3.3</span> Autocorrelation Analysis</a></li>
  <li><a href="#part-1-verdict" id="toc-part-1-verdict" class="nav-link" data-scroll-target="#part-1-verdict"><span class="header-section-number">3.4</span> Part 1 Verdict</a></li>
  </ul></li>
  <li><a href="#part-2-tidy-ml-workflow-for-return-prediction" id="toc-part-2-tidy-ml-workflow-for-return-prediction" class="nav-link" data-scroll-target="#part-2-tidy-ml-workflow-for-return-prediction"><span class="header-section-number">4</span> Part 2: Tidy ML Workflow for Return Prediction</a>
  <ul class="collapse">
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering"><span class="header-section-number">4.1</span> Feature Engineering</a></li>
  <li><a href="#fetch-external-macro-data" id="toc-fetch-external-macro-data" class="nav-link" data-scroll-target="#fetch-external-macro-data"><span class="header-section-number">4.2</span> Fetch External Macro Data</a></li>
  <li><a href="#align-macro-data-to-daily-frequency" id="toc-align-macro-data-to-daily-frequency" class="nav-link" data-scroll-target="#align-macro-data-to-daily-frequency"><span class="header-section-number">4.3</span> Align Macro Data to Daily Frequency</a></li>
  <li><a href="#build-complete-feature-set" id="toc-build-complete-feature-set" class="nav-link" data-scroll-target="#build-complete-feature-set"><span class="header-section-number">4.4</span> Build Complete Feature Set</a></li>
  <li><a href="#step-1-data-sampling-with-rsample" id="toc-step-1-data-sampling-with-rsample" class="nav-link" data-scroll-target="#step-1-data-sampling-with-rsample"><span class="header-section-number">4.5</span> Step 1: Data Sampling with rsample</a></li>
  <li><a href="#step-2-feature-engineering-with-recipes" id="toc-step-2-feature-engineering-with-recipes" class="nav-link" data-scroll-target="#step-2-feature-engineering-with-recipes"><span class="header-section-number">4.6</span> Step 2: Feature Engineering with recipes</a></li>
  <li><a href="#step-3-modeling-with-parsnip" id="toc-step-3-modeling-with-parsnip" class="nav-link" data-scroll-target="#step-3-modeling-with-parsnip"><span class="header-section-number">4.7</span> Step 3: Modeling with parsnip</a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">4.7.1</span> Linear Regression</a></li>
  <li><a href="#decision-tree" id="toc-decision-tree" class="nav-link" data-scroll-target="#decision-tree"><span class="header-section-number">4.7.2</span> Decision Tree</a></li>
  </ul></li>
  <li><a href="#step-7-model-evaluation-with-yardstick" id="toc-step-7-model-evaluation-with-yardstick" class="nav-link" data-scroll-target="#step-7-model-evaluation-with-yardstick"><span class="header-section-number">4.8</span> Step 7: Model Evaluation with yardstick</a></li>
  <li><a href="#directional-accuracy" id="toc-directional-accuracy" class="nav-link" data-scroll-target="#directional-accuracy"><span class="header-section-number">4.9</span> Directional Accuracy</a></li>
  <li><a href="#predicted-vs.-actual-visualization" id="toc-predicted-vs.-actual-visualization" class="nav-link" data-scroll-target="#predicted-vs.-actual-visualization"><span class="header-section-number">4.10</span> Predicted vs.&nbsp;Actual Visualization</a></li>
  <li><a href="#residual-diagnostics" id="toc-residual-diagnostics" class="nav-link" data-scroll-target="#residual-diagnostics"><span class="header-section-number">4.11</span> Residual Diagnostics</a></li>
  </ul></li>
  <li><a href="#part-3-card-level-risk-analysis" id="toc-part-3-card-level-risk-analysis" class="nav-link" data-scroll-target="#part-3-card-level-risk-analysis"><span class="header-section-number">5</span> Part 3: Card-Level Risk Analysis</a>
  <ul class="collapse">
  <li><a href="#calculate-card-level-risk-metrics" id="toc-calculate-card-level-risk-metrics" class="nav-link" data-scroll-target="#calculate-card-level-risk-metrics"><span class="header-section-number">5.1</span> Calculate Card-Level Risk Metrics</a></li>
  <li><a href="#volatility-by-rarity" id="toc-volatility-by-rarity" class="nav-link" data-scroll-target="#volatility-by-rarity"><span class="header-section-number">5.2</span> Volatility by Rarity</a></li>
  <li><a href="#ml-approach-what-drives-card-volatility" id="toc-ml-approach-what-drives-card-volatility" class="nav-link" data-scroll-target="#ml-approach-what-drives-card-volatility"><span class="header-section-number">5.3</span> ML Approach: What Drives Card Volatility?</a></li>
  <li><a href="#decision-tree-volatility-segmentation" id="toc-decision-tree-volatility-segmentation" class="nav-link" data-scroll-target="#decision-tree-volatility-segmentation"><span class="header-section-number">5.4</span> Decision Tree: Volatility Segmentation</a></li>
  <li><a href="#summary-by-rarity" id="toc-summary-by-rarity" class="nav-link" data-scroll-target="#summary-by-rarity"><span class="header-section-number">5.5</span> Summary by Rarity</a></li>
  </ul></li>
  <li><a href="#conclusions-key-findings" id="toc-conclusions-key-findings" class="nav-link" data-scroll-target="#conclusions-key-findings"><span class="header-section-number">6</span> Conclusions &amp; Key Findings</a>
  <ul class="collapse">
  <li><a href="#summary-of-results" id="toc-summary-of-results" class="nav-link" data-scroll-target="#summary-of-results"><span class="header-section-number">6.1</span> Summary of Results</a>
  <ul class="collapse">
  <li><a href="#index-behavior" id="toc-index-behavior" class="nav-link" data-scroll-target="#index-behavior"><span class="header-section-number">6.1.1</span> 1. Index Behavior</a></li>
  <li><a href="#predictability-ml-results" id="toc-predictability-ml-results" class="nav-link" data-scroll-target="#predictability-ml-results"><span class="header-section-number">6.1.2</span> 2. Predictability (ML Results)</a></li>
  <li><a href="#risk-factors" id="toc-risk-factors" class="nav-link" data-scroll-target="#risk-factors"><span class="header-section-number">6.1.3</span> 3. Risk Factors</a></li>
  </ul></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">6.2</span> Limitations</a></li>
  <li><a href="#workflow-summary" id="toc-workflow-summary" class="nav-link" data-scroll-target="#workflow-summary"><span class="header-section-number">6.3</span> Workflow Summary</a></li>
  </ul></li>
  <li><a href="#appendix-session-info" id="toc-appendix-session-info" class="nav-link" data-scroll-target="#appendix-session-info"><span class="header-section-number">7</span> Appendix: Session Info</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pokémon Card Market Analysis</h1>
<p class="subtitle lead">Index Behavior, Predictability &amp; Risk Factors Using Recursive Methods</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your Name </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 2, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="executive-summary" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Executive Summary</h1>
<p><strong>Can Pokémon cards be analyzed like financial instruments?</strong></p>
<p>This analysis investigates whether a portfolio of ~40 Pokémon trading cards exhibits market-like behavior and explores whether returns are predictable. We apply two key methodologies from quantitative finance:</p>
<ol type="1">
<li><strong>The Recursive Regression Method</strong> - Building factor models incrementally while monitoring for multicollinearity</li>
<li><strong>The Tidymodels ML Workflow</strong> - A systematic pipeline using <code>rsample</code> → <code>recipes</code> → <code>parsnip</code> → <code>yardstick</code></li>
</ol>
<p><strong>Key Questions:</strong></p>
<ol type="1">
<li><strong>Index Behavior</strong>: Does an aggregated basket of 40 cards behave like a market index?</li>
<li><strong>Basket Prediction</strong>: Can we predict next-day basket movements using the tidy ML workflow?</li>
<li><strong>Card-Level Risk</strong>: What card characteristics explain volatility differences?</li>
</ol>
<hr>
</section>
<section id="data-loading-cleaning" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Loading &amp; Cleaning</h1>
<section id="load-all-40-card-files" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="load-all-40-card-files"><span class="header-section-number">2.1</span> Load All 40 Card Files</h2>
<p>Each CSV file contains card metadata at the top followed by daily price history. We parse each file and combine them into a single analytical dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to parse a single card file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>parse_card_file <span class="ot">&lt;-</span> <span class="cf">function</span>(filepath, card_id) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  all_lines <span class="ot">&lt;-</span> <span class="fu">readLines</span>(filepath, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find section markers</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  card_info_start <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"CARD INFORMATION"</span>, all_lines))[<span class="dv">1</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  history_start <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"PRICE HISTORY"</span>, all_lines))[<span class="dv">1</span>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract card metadata</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  card_lines <span class="ot">&lt;-</span> all_lines[(card_info_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(history_start <span class="sc">-</span> <span class="dv">3</span>)]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  card_lines <span class="ot">&lt;-</span> card_lines[card_lines <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse card info</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  card_name <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(card_lines[<span class="fu">grepl</span>(<span class="st">"Card Name"</span>, card_lines)], <span class="st">"(?&lt;=Card Name,).*"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  set_name <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(card_lines[<span class="fu">grepl</span>(<span class="st">"Set Name"</span>, card_lines)], <span class="st">"(?&lt;=Set Name,).*"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  rarity <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(card_lines[<span class="fu">grepl</span>(<span class="st">"Rarity"</span>, card_lines)], <span class="st">"(?&lt;=Rarity,).*"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract price history</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  price_history_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">paste</span>(all_lines[(history_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(all_lines)], <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean price history</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  price_history <span class="ot">&lt;-</span> price_history_raw <span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Date =</span> <span class="dv">1</span>, <span class="at">Condition =</span> <span class="dv">2</span>, <span class="at">Price =</span> <span class="dv">3</span>, <span class="at">Volume =</span> <span class="dv">4</span>, <span class="at">DataType =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">substr</span>(<span class="fu">as.character</span>(Date), <span class="dv">1</span>, <span class="dv">10</span>)),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Price =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[</span><span class="sc">\\</span><span class="st">$,]"</span>, <span class="st">""</span>, Price)),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">Volume =</span> <span class="fu">as.numeric</span>(Volume),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">card_id =</span> card_id,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">card_name =</span> <span class="fu">trimws</span>(card_name),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">set_name =</span> <span class="fu">trimws</span>(set_name),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">rarity =</span> <span class="fu">trimws</span>(rarity)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Price), <span class="sc">!</span><span class="fu">is.na</span>(Date))</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(price_history)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all card files</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"C:/Users/kenne/Downloads/Pokemon Project/"</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>df_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) {</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(file_path, <span class="st">"project_data_"</span>, i, <span class="st">".csv"</span>)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(filename)) {</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    df_list[[i]] <span class="ot">&lt;-</span> <span class="fu">parse_card_file</span>(filename, i)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Loaded file"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Warning: File"</span>, i, <span class="st">"not found</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded file 1 
Loaded file 2 
Loaded file 3 
Loaded file 4 
Loaded file 5 
Loaded file 6 
Loaded file 7 
Loaded file 8 
Loaded file 9 
Loaded file 10 
Loaded file 11 
Loaded file 12 
Loaded file 13 
Loaded file 14 
Loaded file 15 
Loaded file 16 
Loaded file 17 
Loaded file 18 
Warning: File 19 not found
Loaded file 20 
Loaded file 21 
Loaded file 22 
Loaded file 23 
Loaded file 24 
Loaded file 25 
Loaded file 26 
Loaded file 27 
Loaded file 28 
Loaded file 29 
Loaded file 30 
Loaded file 31 
Loaded file 32 
Loaded file 33 
Loaded file 34 
Loaded file 35 
Loaded file 36 
Loaded file 37 
Loaded file 38 
Loaded file 39 
Loaded file 40 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all cards</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_list)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total rows loaded:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Total rows loaded: 68076 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of unique cards:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>card_id)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of unique cards: 39 </code></pre>
</div>
</div>
</section>
<section id="focus-on-near-mint-condition" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="focus-on-near-mint-condition"><span class="header-section-number">2.2</span> Focus on Near Mint Condition</h2>
<p>For consistency and liquidity, we focus on “Near Mint” condition cards.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(Condition == "Near Mint") %&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(card_id, Date)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary by card</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>card_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(card_id, card_name, rarity) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_price =</span> <span class="fu">min</span>(Price),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_price =</span> <span class="fu">max</span>(Price),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_price =</span> <span class="fu">mean</span>(Price),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">price_range_pct =</span> (max_price <span class="sc">-</span> min_price) <span class="sc">/</span> min_price <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>card_summary <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_price)) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(<span class="at">columns =</span> <span class="fu">c</span>(min_price, max_price, mean_price), <span class="at">currency =</span> <span class="st">"USD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> price_range_pct, <span class="at">decimals =</span> <span class="dv">1</span>, <span class="at">suffix =</span> <span class="st">"%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">card_id =</span> <span class="st">"ID"</span>, <span class="at">card_name =</span> <span class="st">"Card Name"</span>, <span class="at">rarity =</span> <span class="st">"Rarity"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="st">"Days"</span>, <span class="at">min_price =</span> <span class="st">"Min"</span>, <span class="at">max_price =</span> <span class="st">"Max"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_price =</span> <span class="st">"Avg"</span>, <span class="at">price_range_pct =</span> <span class="st">"Range %"</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Top 15 Cards by Average Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="qeayjdrzqo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qeayjdrzqo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qeayjdrzqo thead, #qeayjdrzqo tbody, #qeayjdrzqo tfoot, #qeayjdrzqo tr, #qeayjdrzqo td, #qeayjdrzqo th {
  border-style: none;
}

#qeayjdrzqo p {
  margin: 0;
  padding: 0;
}

#qeayjdrzqo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qeayjdrzqo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qeayjdrzqo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qeayjdrzqo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qeayjdrzqo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qeayjdrzqo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qeayjdrzqo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qeayjdrzqo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qeayjdrzqo .gt_spanner_row {
  border-bottom-style: hidden;
}

#qeayjdrzqo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qeayjdrzqo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qeayjdrzqo .gt_from_md > :first-child {
  margin-top: 0;
}

#qeayjdrzqo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qeayjdrzqo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qeayjdrzqo .gt_row_group_first td {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_row_group_first th {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qeayjdrzqo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_left {
  text-align: left;
}

#qeayjdrzqo .gt_center {
  text-align: center;
}

#qeayjdrzqo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qeayjdrzqo .gt_font_normal {
  font-weight: normal;
}

#qeayjdrzqo .gt_font_bold {
  font-weight: bold;
}

#qeayjdrzqo .gt_font_italic {
  font-style: italic;
}

#qeayjdrzqo .gt_super {
  font-size: 65%;
}

#qeayjdrzqo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qeayjdrzqo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qeayjdrzqo .gt_indent_1 {
  text-indent: 5px;
}

#qeayjdrzqo .gt_indent_2 {
  text-indent: 10px;
}

#qeayjdrzqo .gt_indent_3 {
  text-indent: 15px;
}

#qeayjdrzqo .gt_indent_4 {
  text-indent: 20px;
}

#qeayjdrzqo .gt_indent_5 {
  text-indent: 25px;
}

#qeayjdrzqo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qeayjdrzqo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border">Top 15 Cards by Average Price</th>
</tr>
<tr class="gt_col_headings even">
<th id="card_id" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ID</th>
<th id="card_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Card Name</th>
<th id="rarity" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Rarity</th>
<th id="n_obs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Days</th>
<th id="min_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min</th>
<th id="max_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max</th>
<th id="mean_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Avg</th>
<th id="price_range_pct" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Range %</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">4</td>
<td class="gt_row gt_left" headers="card_name">Charizard</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$225.00</td>
<td class="gt_row gt_right" headers="max_price">$5,495.00</td>
<td class="gt_row gt_right" headers="mean_price">$1,944.29</td>
<td class="gt_row gt_right" headers="price_range_pct">2.3%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">12</td>
<td class="gt_row gt_left" headers="card_name">Gyarados Star (Delta Species)</td>
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$285.00</td>
<td class="gt_row gt_right" headers="max_price">$1,999.99</td>
<td class="gt_row gt_right" headers="mean_price">$1,048.12</td>
<td class="gt_row gt_right" headers="price_range_pct">601.8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">30</td>
<td class="gt_row gt_left" headers="card_name">Umbreon VMAX (Alternate Art Secret)</td>
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$295.70</td>
<td class="gt_row gt_right" headers="max_price">$2,285.40</td>
<td class="gt_row gt_right" headers="mean_price">$1,029.54</td>
<td class="gt_row gt_right" headers="price_range_pct">672.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">40</td>
<td class="gt_row gt_left" headers="card_name">Mewtwo Star</td>
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_obs">1464</td>
<td class="gt_row gt_right" headers="min_price">$250.98</td>
<td class="gt_row gt_right" headers="max_price">$2,001.98</td>
<td class="gt_row gt_right" headers="mean_price">$872.07</td>
<td class="gt_row gt_right" headers="price_range_pct">697.7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">14</td>
<td class="gt_row gt_left" headers="card_name">Latias Star</td>
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_obs">1098</td>
<td class="gt_row gt_right" headers="min_price">$274.95</td>
<td class="gt_row gt_right" headers="max_price">$2,300.00</td>
<td class="gt_row gt_right" headers="mean_price">$777.53</td>
<td class="gt_row gt_right" headers="price_range_pct">736.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">15</td>
<td class="gt_row gt_left" headers="card_name">Lugia</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$268.86</td>
<td class="gt_row gt_right" headers="max_price">$1,799.99</td>
<td class="gt_row gt_right" headers="mean_price">$726.66</td>
<td class="gt_row gt_right" headers="price_range_pct">569.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">23</td>
<td class="gt_row gt_left" headers="card_name">Shining Tyranitar</td>
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$246.85</td>
<td class="gt_row gt_right" headers="max_price">$1,700.00</td>
<td class="gt_row gt_right" headers="mean_price">$713.36</td>
<td class="gt_row gt_right" headers="price_range_pct">588.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">22</td>
<td class="gt_row gt_left" headers="card_name">Shining Mewtwo</td>
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$126.64</td>
<td class="gt_row gt_right" headers="max_price">$896.01</td>
<td class="gt_row gt_right" headers="mean_price">$589.93</td>
<td class="gt_row gt_right" headers="price_range_pct">607.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">20</td>
<td class="gt_row gt_left" headers="card_name">Rocket's Mewtwo ex</td>
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$153.54</td>
<td class="gt_row gt_right" headers="max_price">$1,999.99</td>
<td class="gt_row gt_right" headers="mean_price">$562.15</td>
<td class="gt_row gt_right" headers="price_range_pct">1.2%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">17</td>
<td class="gt_row gt_left" headers="card_name">Mewtwo</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$205.51</td>
<td class="gt_row gt_right" headers="max_price">$900.00</td>
<td class="gt_row gt_right" headers="mean_price">$469.92</td>
<td class="gt_row gt_right" headers="price_range_pct">337.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">11</td>
<td class="gt_row gt_left" headers="card_name">Gyarados (H10)</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1098</td>
<td class="gt_row gt_right" headers="min_price">$209.00</td>
<td class="gt_row gt_right" headers="max_price">$1,200.00</td>
<td class="gt_row gt_right" headers="mean_price">$439.57</td>
<td class="gt_row gt_right" headers="price_range_pct">474.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">39</td>
<td class="gt_row gt_left" headers="card_name">Pikachu VMAX</td>
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_obs">732</td>
<td class="gt_row gt_right" headers="min_price">$262.50</td>
<td class="gt_row gt_right" headers="max_price">$362.48</td>
<td class="gt_row gt_right" headers="mean_price">$294.24</td>
<td class="gt_row gt_right" headers="price_range_pct">38.1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">29</td>
<td class="gt_row gt_left" headers="card_name">Tyranitar (H28)</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$60.00</td>
<td class="gt_row gt_right" headers="max_price">$615.95</td>
<td class="gt_row gt_right" headers="mean_price">$278.99</td>
<td class="gt_row gt_right" headers="price_range_pct">926.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="card_id">5</td>
<td class="gt_row gt_left" headers="card_name">Charizard</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$112.21</td>
<td class="gt_row gt_right" headers="max_price">$494.04</td>
<td class="gt_row gt_right" headers="mean_price">$268.99</td>
<td class="gt_row gt_right" headers="price_range_pct">340.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="card_id">38</td>
<td class="gt_row gt_left" headers="card_name">Pikachu with Grey Felt Hat</td>
<td class="gt_row gt_left" headers="rarity">Promo</td>
<td class="gt_row gt_right" headers="n_obs">1830</td>
<td class="gt_row gt_right" headers="min_price">$50.00</td>
<td class="gt_row gt_right" headers="max_price">$649.30</td>
<td class="gt_row gt_right" headers="mean_price">$251.63</td>
<td class="gt_row gt_right" headers="price_range_pct">1.2%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Commentary:</strong> The price distribution shows substantial heterogeneity—from cards worth a few dollars to those over $2,000. This mirrors real financial markets where asset prices span multiple orders of magnitude.</p>
</section>
<section id="calculate-returns" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="calculate-returns"><span class="header-section-number">2.3</span> Calculate Returns</h2>
<hr>
</section>
</section>
<section id="part-1-does-the-basket-behave-like-a-market-index" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Part 1: Does the Basket Behave Like a Market Index?</h1>
<p>A true market index typically displays:</p>
<ul>
<li><strong>Fat tails</strong> (kurtosis &gt; 3): More extreme events than normal distribution predicts</li>
<li><strong>Negative skewness</strong>: Crashes larger than rallies</li>
<li><strong>Volatility clustering</strong>: Calm periods followed by turbulent periods</li>
<li><strong>Weak return autocorrelation</strong>: Returns hard to predict, but volatility persists</li>
</ul>
<section id="construct-the-basket-index" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="construct-the-basket-index"><span class="header-section-number">3.1</span> Construct the Basket Index</h2>
<p>We create two indices similar to how market indices are constructed:</p>
<ol type="1">
<li><strong>Value-Weighted</strong>: Weight proportional to price (like S&amp;P 500 market-cap weighting)</li>
<li><strong>Equal-Weighted</strong>: Each card receives equal weight (1/N)</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/construct-index-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Commentary:</strong> The divergence between value-weighted and equal-weighted indices tells a story. If high-priced “blue chip” cards behave differently from cheaper cards, the indices will separate—similar to how large-cap stocks often exhibit lower volatility than small-caps.</p>
</section>
<section id="statistical-properties" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="statistical-properties"><span class="header-section-number">3.2</span> Statistical Properties</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>returns <span class="ot">&lt;-</span> basket_index<span class="sc">$</span>basket_return</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>stats_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Mean (daily)"</span>, <span class="st">"Std Dev (daily)"</span>, <span class="st">"Annualized Vol"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Skewness"</span>, <span class="st">"Kurtosis"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"Sharpe (ann.)"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    e1071<span class="sc">::</span><span class="fu">skewness</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    e1071<span class="sc">::</span><span class="fu">kurtosis</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">round</span>(Value, <span class="dv">4</span>))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>stats_table <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Basket Index: Statistical Properties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xgdyentzro" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xgdyentzro table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xgdyentzro thead, #xgdyentzro tbody, #xgdyentzro tfoot, #xgdyentzro tr, #xgdyentzro td, #xgdyentzro th {
  border-style: none;
}

#xgdyentzro p {
  margin: 0;
  padding: 0;
}

#xgdyentzro .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xgdyentzro .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xgdyentzro .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xgdyentzro .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xgdyentzro .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xgdyentzro .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xgdyentzro .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xgdyentzro .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xgdyentzro .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xgdyentzro .gt_spanner_row {
  border-bottom-style: hidden;
}

#xgdyentzro .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xgdyentzro .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xgdyentzro .gt_from_md > :first-child {
  margin-top: 0;
}

#xgdyentzro .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xgdyentzro .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xgdyentzro .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xgdyentzro .gt_row_group_first td {
  border-top-width: 2px;
}

#xgdyentzro .gt_row_group_first th {
  border-top-width: 2px;
}

#xgdyentzro .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xgdyentzro .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xgdyentzro .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xgdyentzro .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xgdyentzro .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_left {
  text-align: left;
}

#xgdyentzro .gt_center {
  text-align: center;
}

#xgdyentzro .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xgdyentzro .gt_font_normal {
  font-weight: normal;
}

#xgdyentzro .gt_font_bold {
  font-weight: bold;
}

#xgdyentzro .gt_font_italic {
  font-style: italic;
}

#xgdyentzro .gt_super {
  font-size: 65%;
}

#xgdyentzro .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xgdyentzro .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xgdyentzro .gt_indent_1 {
  text-indent: 5px;
}

#xgdyentzro .gt_indent_2 {
  text-indent: 10px;
}

#xgdyentzro .gt_indent_3 {
  text-indent: 15px;
}

#xgdyentzro .gt_indent_4 {
  text-indent: 20px;
}

#xgdyentzro .gt_indent_5 {
  text-indent: 25px;
}

#xgdyentzro .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xgdyentzro div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border">Basket Index: Statistical Properties</th>
</tr>
<tr class="gt_col_headings even">
<th id="Statistic" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Statistic</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Statistic">Mean (daily)</td>
<td class="gt_row gt_right" headers="Value">2.7548</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistic">Std Dev (daily)</td>
<td class="gt_row gt_right" headers="Value">0.3130</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistic">Annualized Vol</td>
<td class="gt_row gt_right" headers="Value">4.9683</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistic">Skewness</td>
<td class="gt_row gt_right" headers="Value">0.1636</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistic">Kurtosis</td>
<td class="gt_row gt_right" headers="Value">-0.3228</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistic">Min</td>
<td class="gt_row gt_right" headers="Value">1.6866</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistic">Max</td>
<td class="gt_row gt_right" headers="Value">3.5200</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistic">Sharpe (ann.)</td>
<td class="gt_row gt_right" headers="Value">139.7249</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(basket_index, <span class="fu">aes</span>(<span class="at">x =</span> basket_return)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#3498db"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd =</span> <span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Return Distribution vs. Normal"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red line = theoretical normal distribution"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Daily Return"</span>, <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/return-distribution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Commentary:</strong></p>
<ul>
<li><strong>Kurtosis &gt; 3</strong> indicates fat tails—extreme returns occur more frequently than normal predicts</li>
<li><strong>Skewness</strong>: Positive suggests occasional large positive jumps; negative indicates crash-prone behavior</li>
<li>Low annualized volatility may reflect interpolated prices or illiquid market nature</li>
</ul>
</section>
<section id="autocorrelation-analysis" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="autocorrelation-analysis"><span class="header-section-number">3.3</span> Autocorrelation Analysis</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(returns, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Return ACF"</span>, <span class="at">na.action =</span> na.pass)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(returns<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Squared Returns ACF</span><span class="sc">\n</span><span class="st">(Volatility Clustering)"</span>, <span class="at">na.action =</span> na.pass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/autocorrelation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Commentary:</strong></p>
<ul>
<li><strong>Return ACF</strong>: Bars within blue bands = returns unpredictable from past (market efficiency)</li>
<li><strong>Squared Returns ACF</strong>: Significant autocorrelation = volatility clustering (ARCH/GARCH effect)</li>
</ul>
</section>
<section id="part-1-verdict" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="part-1-verdict"><span class="header-section-number">3.4</span> Part 1 Verdict</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>kurt <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">kurtosis</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>skew <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">skewness</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ann_vol <span class="ot">&lt;-</span> <span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Property =</span> <span class="fu">c</span>(<span class="st">"Fat Tails (Kurtosis &gt; 3)"</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Negative Skewness"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"High Volatility (&gt;20% ann.)"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Volatility Clustering"</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Expected =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed =</span> <span class="fu">c</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(kurt <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="fu">paste0</span>(<span class="st">"✓ Yes ("</span>, <span class="fu">round</span>(kurt, <span class="dv">2</span>), <span class="st">")"</span>), <span class="fu">paste0</span>(<span class="st">"✗ No ("</span>, <span class="fu">round</span>(kurt, <span class="dv">2</span>), <span class="st">")"</span>)),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(skew <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="fu">paste0</span>(<span class="st">"✓ Yes ("</span>, <span class="fu">round</span>(skew, <span class="dv">2</span>), <span class="st">")"</span>), <span class="fu">paste0</span>(<span class="st">"✗ No ("</span>, <span class="fu">round</span>(skew, <span class="dv">2</span>), <span class="st">")"</span>)),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(ann_vol <span class="sc">&gt;</span> <span class="fl">0.20</span>, <span class="fu">paste0</span>(<span class="st">"✓ Yes ("</span>, <span class="fu">round</span>(ann_vol<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)"</span>), <span class="fu">paste0</span>(<span class="st">"✗ No ("</span>, <span class="fu">round</span>(ann_vol<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)"</span>)),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Check ACF plot"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Does the Pokémon Card Basket Behave Like a Market Index?"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison against typical financial market properties"</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ciydemetbh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ciydemetbh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ciydemetbh thead, #ciydemetbh tbody, #ciydemetbh tfoot, #ciydemetbh tr, #ciydemetbh td, #ciydemetbh th {
  border-style: none;
}

#ciydemetbh p {
  margin: 0;
  padding: 0;
}

#ciydemetbh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ciydemetbh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ciydemetbh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ciydemetbh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ciydemetbh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ciydemetbh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ciydemetbh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ciydemetbh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ciydemetbh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ciydemetbh .gt_spanner_row {
  border-bottom-style: hidden;
}

#ciydemetbh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ciydemetbh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ciydemetbh .gt_from_md > :first-child {
  margin-top: 0;
}

#ciydemetbh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ciydemetbh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ciydemetbh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ciydemetbh .gt_row_group_first td {
  border-top-width: 2px;
}

#ciydemetbh .gt_row_group_first th {
  border-top-width: 2px;
}

#ciydemetbh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ciydemetbh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ciydemetbh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ciydemetbh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ciydemetbh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_left {
  text-align: left;
}

#ciydemetbh .gt_center {
  text-align: center;
}

#ciydemetbh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ciydemetbh .gt_font_normal {
  font-weight: normal;
}

#ciydemetbh .gt_font_bold {
  font-weight: bold;
}

#ciydemetbh .gt_font_italic {
  font-style: italic;
}

#ciydemetbh .gt_super {
  font-size: 65%;
}

#ciydemetbh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ciydemetbh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ciydemetbh .gt_indent_1 {
  text-indent: 5px;
}

#ciydemetbh .gt_indent_2 {
  text-indent: 10px;
}

#ciydemetbh .gt_indent_3 {
  text-indent: 15px;
}

#ciydemetbh .gt_indent_4 {
  text-indent: 20px;
}

#ciydemetbh .gt_indent_5 {
  text-indent: 25px;
}

#ciydemetbh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ciydemetbh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Does the Pokémon Card Basket Behave Like a Market Index?</th>
</tr>
<tr class="gt_heading even">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Comparison against typical financial market properties</th>
</tr>
<tr class="gt_col_headings header">
<th id="Property" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Property</th>
<th id="Expected" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Expected</th>
<th id="Observed" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Observed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Property">Fat Tails (Kurtosis &gt; 3)</td>
<td class="gt_row gt_left" headers="Expected">Yes</td>
<td class="gt_row gt_left" headers="Observed">✗ No (-0.32)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Property">Negative Skewness</td>
<td class="gt_row gt_left" headers="Expected">Yes</td>
<td class="gt_row gt_left" headers="Observed">✗ No (0.16)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Property">High Volatility (&gt;20% ann.)</td>
<td class="gt_row gt_left" headers="Expected">Yes</td>
<td class="gt_row gt_left" headers="Observed">✓ Yes (496.8%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Property">Volatility Clustering</td>
<td class="gt_row gt_left" headers="Expected">Yes</td>
<td class="gt_row gt_left" headers="Observed">Check ACF plot</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="part-2-tidy-ml-workflow-for-return-prediction" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Part 2: Tidy ML Workflow for Return Prediction</h1>
<p>We now apply the <strong>Tidymodels workflow</strong> from the class notes to predict next-day basket returns. The workflow follows:</p>
<ol type="1">
<li><strong><code>rsample</code></strong>: Data sampling (train/test split)</li>
<li><strong><code>recipes</code></strong>: Feature engineering pipeline</li>
<li><strong><code>parsnip</code></strong>: Model specification and fitting</li>
<li><strong><code>yardstick</code></strong>: Model evaluation metrics</li>
</ol>
<section id="feature-engineering" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="feature-engineering"><span class="header-section-number">4.1</span> Feature Engineering</h2>
<p>We create three categories of predictors:</p>
<ol type="1">
<li><strong>Internal features</strong>: Lagged card market returns and volatility</li>
<li><strong>External/Macro features</strong>: Consumer sentiment, S&amp;P 500 (risk appetite proxy)</li>
<li><strong>Calendar features</strong>: Day of week, month-end effects, holiday season</li>
</ol>
</section>
<section id="fetch-external-macro-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="fetch-external-macro-data"><span class="header-section-number">4.2</span> Fetch External Macro Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consumer Sentiment Index (Monthly from FRED)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>consumer_sentiment <span class="ot">&lt;-</span> tidyquant<span class="sc">::</span><span class="fu">tq_get</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UMCSENT"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">get =</span> <span class="st">"economic.data"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(basket_index<span class="sc">$</span>Date) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">90</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(basket_index<span class="sc">$</span>Date)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> date, <span class="at">sentiment_index =</span> price) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, sentiment_index)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Consumer Sentiment observations:"</span>, <span class="fu">nrow</span>(consumer_sentiment), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Consumer Sentiment observations: 13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 via SPY ETF (Daily)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>spy_data <span class="ot">&lt;-</span> tidyquant<span class="sc">::</span><span class="fu">tq_get</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SPY"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">get =</span> <span class="st">"stock.prices"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(basket_index<span class="sc">$</span>Date) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">30</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(basket_index<span class="sc">$</span>Date)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spy_return =</span> (adjusted <span class="sc">-</span> <span class="fu">lag</span>(adjusted)) <span class="sc">/</span> <span class="fu">lag</span>(adjusted)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="at">spy_close =</span> adjusted, spy_return)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SPY observations:"</span>, <span class="fu">nrow</span>(spy_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>SPY observations: 269 </code></pre>
</div>
</div>
</section>
<section id="align-macro-data-to-daily-frequency" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="align-macro-data-to-daily-frequency"><span class="header-section-number">4.3</span> Align Macro Data to Daily Frequency</h2>
<p>Consumer sentiment is monthly—we fill-forward to daily. SPY needs handling for weekends when card trading may occur.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create complete daily date sequence</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>all_dates <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(basket_index<span class="sc">$</span>Date), <span class="fu">max</span>(basket_index<span class="sc">$</span>Date), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Expand monthly sentiment to daily (fill forward)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>sentiment_without_regards <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(consumer_sentiment<span class="sc">$</span>Date), <span class="fu">max</span>(all_dates<span class="sc">$</span>Date), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(consumer_sentiment, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(sentiment_index, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Fill forward FIRST</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(sentiment_index, <span class="at">.direction =</span> <span class="st">"up"</span>)         <span class="co"># Fill any leading NAs</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># THEN: Join to your basket dates (already filled!)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>sentiment_daily <span class="ot">&lt;-</span> all_dates <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sentiment_without_regards, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># SPY: fill weekends/holidays, set return to 0 on non-trading days</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>spy_daily <span class="ot">&lt;-</span> all_dates <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(spy_data, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(spy_close, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spy_return =</span> <span class="fu">replace_na</span>(spy_return, <span class="dv">0</span>))</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sentiment daily:"</span>, <span class="fu">nrow</span>(sentiment_daily), <span class="st">"| SPY daily:"</span>, <span class="fu">nrow</span>(spy_daily), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sentiment daily: 366 | SPY daily: 366 </code></pre>
</div>
</div>
</section>
<section id="build-complete-feature-set" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="build-complete-feature-set"><span class="header-section-number">4.4</span> Build Complete Feature Set</h2>
<p><strong>Critical</strong>: All rolling features are LAGGED to avoid lookahead bias.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>basket_features <span class="ot">&lt;-</span> basket_index <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sentiment_daily, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(spy_daily, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TARGET</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_next =</span> <span class="fu">lead</span>(basket_return),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INTERNAL FEATURES (lagged)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_lag1 =</span> <span class="fu">lag</span>(basket_return, <span class="dv">1</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_lag2 =</span> <span class="fu">lag</span>(basket_return, <span class="dv">2</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_lag3 =</span> <span class="fu">lag</span>(basket_return, <span class="dv">3</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_lag5 =</span> <span class="fu">lag</span>(basket_return, <span class="dv">5</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_5d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollsum</span>(basket_return, <span class="dv">5</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">return_10d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollsum</span>(basket_return, <span class="dv">10</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">vol_5d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollapply</span>(basket_return, <span class="dv">5</span>, sd, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">vol_10d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollapply</span>(basket_return, <span class="dv">10</span>, sd, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># EXTERNAL MACRO FEATURES (lagged)</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentiment_lag1 =</span> <span class="fu">lag</span>(sentiment_index, <span class="dv">1</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentiment_change =</span> <span class="fu">lag</span>(sentiment_index, <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">lag</span>(sentiment_index, <span class="dv">30</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">spy_lag1 =</span> <span class="fu">lag</span>(spy_return, <span class="dv">1</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">spy_5d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollsum</span>(spy_return, <span class="dv">5</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">spy_vol_5d =</span> <span class="fu">lag</span>(zoo<span class="sc">::</span><span class="fu">rollapply</span>(spy_return, <span class="dv">5</span>, sd, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>), <span class="dv">1</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CALENDAR FEATURES</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">dow =</span> <span class="fu">wday</span>(Date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_month_end =</span> <span class="fu">ifelse</span>(<span class="fu">day</span>(Date) <span class="sc">&gt;=</span> <span class="dv">28</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_holiday_season =</span> <span class="fu">ifelse</span>(<span class="fu">month</span>(Date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(return_next), <span class="sc">!</span><span class="fu">is.na</span>(return_lag1), <span class="sc">!</span><span class="fu">is.na</span>(spy_lag1))</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Feature set:"</span>, <span class="fu">nrow</span>(basket_features), <span class="st">"obs x"</span>, <span class="fu">ncol</span>(basket_features), <span class="st">"columns</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Feature set: 364 obs x 28 columns</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(basket_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 364
Columns: 28
$ Date                &lt;date&gt; 2024-12-02, 2024-12-03, 2024-12-04, 2024-12-05, 2…
$ total_value         &lt;dbl&gt; 49613.58, 49676.84, 49709.86, 49742.96, 49775.95, …
$ basket_return       &lt;dbl&gt; 2.847785, 2.963306, 3.401531, 3.398920, 3.396504, …
$ equal_weight_return &lt;dbl&gt; 1.220751, 1.801754, 2.052647, 2.052182, 2.051858, …
$ n_cards             &lt;int&gt; 186, 186, 186, 186, 186, 186, 186, 186, 186, 186, …
$ total_volume        &lt;dbl&gt; 167, 0, 0, 0, 0, 0, 0, 558, 0, 0, 0, 0, 0, 0, 697,…
$ basket_level        &lt;dbl&gt; 1.739209e+01, 6.893015e+01, 3.033982e+02, 1.334624…
$ ew_level            &lt;dbl&gt; 7.012709e+00, 1.964789e+01, 5.997807e+01, 1.830640…
$ sentiment_index     &lt;dbl&gt; 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74…
$ spy_close           &lt;dbl&gt; 596.3795, 596.6561, 600.3611, 599.3731, 600.5093, …
$ spy_return          &lt;dbl&gt; 1.792364e-03, 4.638176e-04, 6.209533e-03, -1.64563…
$ return_next         &lt;dbl&gt; 2.963306, 3.401531, 3.398920, 3.396504, 3.394259, …
$ return_lag1         &lt;dbl&gt; 3.520025, 2.847785, 2.963306, 3.401531, 3.398920, …
$ return_lag2         &lt;dbl&gt; NA, 3.520025, 2.847785, 2.963306, 3.401531, 3.3989…
$ return_lag3         &lt;dbl&gt; NA, NA, 3.520025, 2.847785, 2.963306, 3.401531, 3.…
$ return_lag5         &lt;dbl&gt; NA, NA, NA, NA, 3.520025, 2.847785, 2.963306, 3.40…
$ return_5d           &lt;dbl&gt; NA, NA, NA, NA, 16.13157, 16.00805, 16.55452, 16.9…
$ return_10d          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 32.06642, 31.9…
$ vol_5d              &lt;dbl&gt; NA, NA, NA, NA, 0.2996739155, 0.2733424647, 0.1943…
$ vol_10d             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.2769729, 0.2…
$ sentiment_lag1      &lt;dbl&gt; 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74…
$ sentiment_change    &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ spy_lag1            &lt;dbl&gt; 0.000000e+00, 1.792364e-03, 4.638176e-04, 6.209533…
$ spy_5d              &lt;dbl&gt; NA, NA, NA, NA, 6.820078e-03, 8.715675e-03, 6.9233…
$ spy_vol_5d          &lt;dbl&gt; NA, NA, NA, NA, 0.002974535, 0.002876404, 0.002978…
$ dow                 &lt;ord&gt; Mon, Tue, Wed, Thu, Fri, Sat, Sun, Mon, Tue, Wed, …
$ is_month_end        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ is_holiday_season   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</code></pre>
</div>
</div>
</section>
<section id="step-1-data-sampling-with-rsample" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="step-1-data-sampling-with-rsample"><span class="header-section-number">4.5</span> Step 1: Data Sampling with rsample</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_split <span class="ot">&lt;-</span> basket_features <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  rsample<span class="sc">::</span><span class="fu">initial_time_split</span>(<span class="at">prop =</span> <span class="fl">0.70</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>df_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(df_split)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(df_split)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training:"</span>, <span class="fu">nrow</span>(df_train), <span class="st">"obs ("</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(<span class="fu">min</span>(df_train<span class="sc">$</span>Date)), <span class="st">"to"</span>, <span class="fu">as.character</span>(<span class="fu">max</span>(df_train<span class="sc">$</span>Date)), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training: 254 obs ( 2024-12-02 to 2025-08-12 )</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing:"</span>, <span class="fu">nrow</span>(df_test), <span class="st">"obs ("</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(<span class="fu">min</span>(df_test<span class="sc">$</span>Date)), <span class="st">"to"</span>, <span class="fu">as.character</span>(<span class="fu">max</span>(df_test<span class="sc">$</span>Date)), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Testing: 110 obs ( 2025-08-13 to 2025-11-30 )</code></pre>
</div>
</div>
</section>
<section id="step-2-feature-engineering-with-recipes" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="step-2-feature-engineering-with-recipes"><span class="header-section-number">4.6</span> Step 2: Feature Engineering with recipes</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>recipe_pipeline <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  return_next <span class="sc">~</span> return_lag1 <span class="sc">+</span> return_lag2 <span class="sc">+</span> return_lag3 <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                return_5d <span class="sc">+</span> vol_5d <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                sentiment_lag1 <span class="sc">+</span> spy_lag1 <span class="sc">+</span> spy_5d <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                dow <span class="sc">+</span> is_holiday_season,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_train</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(dow, <span class="at">one_hot =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_corr</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">threshold =</span> <span class="fl">0.9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">prep</span>()</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>train_baked <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">bake</span>(recipe_pipeline, df_train)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>test_baked <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">bake</span>(recipe_pipeline, df_test)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Baked training:"</span>, <span class="fu">nrow</span>(train_baked), <span class="st">"x"</span>, <span class="fu">ncol</span>(train_baked), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Baked training: 254 x 16 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Baked testing:"</span>, <span class="fu">nrow</span>(test_baked), <span class="st">"x"</span>, <span class="fu">ncol</span>(test_baked), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Baked testing: 110 x 16 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(train_baked)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 254
Columns: 16
$ return_lag1       &lt;dbl&gt; 2.32789983, -0.01461722, 0.38793082, 1.91498904, 1.9…
$ return_lag2       &lt;dbl&gt; -0.23435748, 2.33677384, -0.02102443, 0.38414960, 1.…
$ return_lag3       &lt;dbl&gt; -0.22164835, -0.22164835, 2.34058091, -0.02567395, 0…
$ return_5d         &lt;dbl&gt; -0.02977834, -0.02977834, -0.02977834, -0.02977834, …
$ vol_5d            &lt;dbl&gt; 0.07445547, 0.07445547, 0.07445547, 0.07445547, 1.93…
$ sentiment_lag1    &lt;dbl&gt; 1.640224, 1.640224, 1.640224, 1.640224, 1.640224, 1.…
$ spy_lag1          &lt;dbl&gt; -0.02709861, 0.12677112, 0.01271892, 0.50597353, -0.…
$ spy_5d            &lt;dbl&gt; 0.10252396, 0.10252396, 0.10252396, 0.10252396, 0.21…
$ is_holiday_season &lt;dbl&gt; 2.727136, 2.727136, 2.727136, 2.727136, 2.727136, 2.…
$ return_next       &lt;dbl&gt; 2.963306, 3.401531, 3.398920, 3.396504, 3.394259, 3.…
$ dow_1             &lt;dbl&gt; -0.993621076, -0.493859188, 0.005902699, 0.505664587…
$ dow_2             &lt;dbl&gt; 0.003411255, -0.863047406, -1.151866959, -0.86304740…
$ dow_3             &lt;dbl&gt; 1.068844495, 1.068844495, -0.008482893, -1.085810281…
$ dow_4             &lt;dbl&gt; -1.4836605, 0.2176928, 1.2810387, 0.2176928, -1.4836…
$ dow_5             &lt;dbl&gt; 1.150356727, -1.435400871, 0.001131128, 1.437663127,…
$ dow_6             &lt;dbl&gt; -0.52430786, 1.29999621, -1.74051058, 1.29999621, -0…</code></pre>
</div>
</div>
<p><strong>Commentary:</strong> The recipe handles:</p>
<ul>
<li><code>step_impute_median()</code>: Fills NAs in macro data</li>
<li><code>step_dummy()</code>: Converts day-of-week to binary</li>
<li><code>step_normalize()</code>: Scales features (critical when mixing returns with sentiment indices)</li>
<li><code>step_corr()</code>: Removes highly correlated features</li>
</ul>
</section>
<section id="step-3-modeling-with-parsnip" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="step-3-modeling-with-parsnip"><span class="header-section-number">4.7</span> Step 3: Modeling with parsnip</h2>
<section id="linear-regression" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">4.7.1</span> Linear Regression</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(return_next <span class="sc">~</span> ., <span class="at">data =</span> train_baked)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(model_lm) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Linear Regression Coefficients (With Macro)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="quzrffbtcv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#quzrffbtcv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#quzrffbtcv thead, #quzrffbtcv tbody, #quzrffbtcv tfoot, #quzrffbtcv tr, #quzrffbtcv td, #quzrffbtcv th {
  border-style: none;
}

#quzrffbtcv p {
  margin: 0;
  padding: 0;
}

#quzrffbtcv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#quzrffbtcv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#quzrffbtcv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#quzrffbtcv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#quzrffbtcv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#quzrffbtcv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quzrffbtcv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#quzrffbtcv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#quzrffbtcv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#quzrffbtcv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#quzrffbtcv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#quzrffbtcv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#quzrffbtcv .gt_spanner_row {
  border-bottom-style: hidden;
}

#quzrffbtcv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#quzrffbtcv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#quzrffbtcv .gt_from_md > :first-child {
  margin-top: 0;
}

#quzrffbtcv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#quzrffbtcv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#quzrffbtcv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#quzrffbtcv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#quzrffbtcv .gt_row_group_first td {
  border-top-width: 2px;
}

#quzrffbtcv .gt_row_group_first th {
  border-top-width: 2px;
}

#quzrffbtcv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#quzrffbtcv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#quzrffbtcv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#quzrffbtcv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quzrffbtcv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#quzrffbtcv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#quzrffbtcv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#quzrffbtcv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#quzrffbtcv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quzrffbtcv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#quzrffbtcv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#quzrffbtcv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#quzrffbtcv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#quzrffbtcv .gt_left {
  text-align: left;
}

#quzrffbtcv .gt_center {
  text-align: center;
}

#quzrffbtcv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#quzrffbtcv .gt_font_normal {
  font-weight: normal;
}

#quzrffbtcv .gt_font_bold {
  font-weight: bold;
}

#quzrffbtcv .gt_font_italic {
  font-style: italic;
}

#quzrffbtcv .gt_super {
  font-size: 65%;
}

#quzrffbtcv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#quzrffbtcv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#quzrffbtcv .gt_indent_1 {
  text-indent: 5px;
}

#quzrffbtcv .gt_indent_2 {
  text-indent: 10px;
}

#quzrffbtcv .gt_indent_3 {
  text-indent: 15px;
}

#quzrffbtcv .gt_indent_4 {
  text-indent: 20px;
}

#quzrffbtcv .gt_indent_5 {
  text-indent: 25px;
}

#quzrffbtcv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#quzrffbtcv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Linear Regression Coefficients (With Macro)</th>
</tr>
<tr class="gt_col_headings even">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">std.error</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">statistic</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p.value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">(Intercept)</td>
<td class="gt_row gt_right" headers="estimate">2.84528</td>
<td class="gt_row gt_right" headers="std.error">0.00393</td>
<td class="gt_row gt_right" headers="statistic">724.33945</td>
<td class="gt_row gt_right" headers="p.value">0.00000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">return_lag1</td>
<td class="gt_row gt_right" headers="estimate">0.13895</td>
<td class="gt_row gt_right" headers="std.error">0.01509</td>
<td class="gt_row gt_right" headers="statistic">9.20652</td>
<td class="gt_row gt_right" headers="p.value">0.00000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">return_lag2</td>
<td class="gt_row gt_right" headers="estimate">0.07113</td>
<td class="gt_row gt_right" headers="std.error">0.01705</td>
<td class="gt_row gt_right" headers="statistic">4.17132</td>
<td class="gt_row gt_right" headers="p.value">0.00004</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">return_lag3</td>
<td class="gt_row gt_right" headers="estimate">0.06634</td>
<td class="gt_row gt_right" headers="std.error">0.01820</td>
<td class="gt_row gt_right" headers="statistic">3.64552</td>
<td class="gt_row gt_right" headers="p.value">0.00033</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">return_5d</td>
<td class="gt_row gt_right" headers="estimate">-0.06368</td>
<td class="gt_row gt_right" headers="std.error">0.02444</td>
<td class="gt_row gt_right" headers="statistic">-2.60511</td>
<td class="gt_row gt_right" headers="p.value">0.00976</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">vol_5d</td>
<td class="gt_row gt_right" headers="estimate">0.14550</td>
<td class="gt_row gt_right" headers="std.error">0.01112</td>
<td class="gt_row gt_right" headers="statistic">13.07910</td>
<td class="gt_row gt_right" headers="p.value">0.00000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">sentiment_lag1</td>
<td class="gt_row gt_right" headers="estimate">-0.01774</td>
<td class="gt_row gt_right" headers="std.error">0.00589</td>
<td class="gt_row gt_right" headers="statistic">-3.01339</td>
<td class="gt_row gt_right" headers="p.value">0.00286</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">spy_lag1</td>
<td class="gt_row gt_right" headers="estimate">-0.00076</td>
<td class="gt_row gt_right" headers="std.error">0.00443</td>
<td class="gt_row gt_right" headers="statistic">-0.17180</td>
<td class="gt_row gt_right" headers="p.value">0.86374</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">spy_5d</td>
<td class="gt_row gt_right" headers="estimate">0.00137</td>
<td class="gt_row gt_right" headers="std.error">0.00443</td>
<td class="gt_row gt_right" headers="statistic">0.31060</td>
<td class="gt_row gt_right" headers="p.value">0.75638</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">is_holiday_season</td>
<td class="gt_row gt_right" headers="estimate">0.00587</td>
<td class="gt_row gt_right" headers="std.error">0.00530</td>
<td class="gt_row gt_right" headers="statistic">1.10774</td>
<td class="gt_row gt_right" headers="p.value">0.26909</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">dow_1</td>
<td class="gt_row gt_right" headers="estimate">0.05162</td>
<td class="gt_row gt_right" headers="std.error">0.00765</td>
<td class="gt_row gt_right" headers="statistic">6.74360</td>
<td class="gt_row gt_right" headers="p.value">0.00000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">dow_2</td>
<td class="gt_row gt_right" headers="estimate">-0.13506</td>
<td class="gt_row gt_right" headers="std.error">0.00779</td>
<td class="gt_row gt_right" headers="statistic">-17.32802</td>
<td class="gt_row gt_right" headers="p.value">0.00000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">dow_3</td>
<td class="gt_row gt_right" headers="estimate">0.03872</td>
<td class="gt_row gt_right" headers="std.error">0.00872</td>
<td class="gt_row gt_right" headers="statistic">4.44019</td>
<td class="gt_row gt_right" headers="p.value">0.00001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">dow_4</td>
<td class="gt_row gt_right" headers="estimate">0.01843</td>
<td class="gt_row gt_right" headers="std.error">0.00939</td>
<td class="gt_row gt_right" headers="statistic">1.96284</td>
<td class="gt_row gt_right" headers="p.value">0.05083</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">dow_5</td>
<td class="gt_row gt_right" headers="estimate">-0.02490</td>
<td class="gt_row gt_right" headers="std.error">0.00768</td>
<td class="gt_row gt_right" headers="statistic">-3.24042</td>
<td class="gt_row gt_right" headers="p.value">0.00136</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">dow_6</td>
<td class="gt_row gt_right" headers="estimate">0.00864</td>
<td class="gt_row gt_right" headers="std.error">0.00474</td>
<td class="gt_row gt_right" headers="statistic">1.82264</td>
<td class="gt_row gt_right" headers="p.value">0.06961</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">glance</span>(model_lm) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared, sigma, statistic, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(r.squared, adj.r.squared, sigma), <span class="at">decimals =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Linear Model Summary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ubwfzjheaq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ubwfzjheaq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ubwfzjheaq thead, #ubwfzjheaq tbody, #ubwfzjheaq tfoot, #ubwfzjheaq tr, #ubwfzjheaq td, #ubwfzjheaq th {
  border-style: none;
}

#ubwfzjheaq p {
  margin: 0;
  padding: 0;
}

#ubwfzjheaq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ubwfzjheaq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ubwfzjheaq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ubwfzjheaq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ubwfzjheaq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubwfzjheaq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubwfzjheaq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubwfzjheaq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ubwfzjheaq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ubwfzjheaq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ubwfzjheaq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ubwfzjheaq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ubwfzjheaq .gt_spanner_row {
  border-bottom-style: hidden;
}

#ubwfzjheaq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ubwfzjheaq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ubwfzjheaq .gt_from_md > :first-child {
  margin-top: 0;
}

#ubwfzjheaq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ubwfzjheaq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ubwfzjheaq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ubwfzjheaq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ubwfzjheaq .gt_row_group_first td {
  border-top-width: 2px;
}

#ubwfzjheaq .gt_row_group_first th {
  border-top-width: 2px;
}

#ubwfzjheaq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubwfzjheaq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ubwfzjheaq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ubwfzjheaq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubwfzjheaq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubwfzjheaq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ubwfzjheaq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ubwfzjheaq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ubwfzjheaq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubwfzjheaq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubwfzjheaq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubwfzjheaq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubwfzjheaq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubwfzjheaq .gt_left {
  text-align: left;
}

#ubwfzjheaq .gt_center {
  text-align: center;
}

#ubwfzjheaq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ubwfzjheaq .gt_font_normal {
  font-weight: normal;
}

#ubwfzjheaq .gt_font_bold {
  font-weight: bold;
}

#ubwfzjheaq .gt_font_italic {
  font-style: italic;
}

#ubwfzjheaq .gt_super {
  font-size: 65%;
}

#ubwfzjheaq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ubwfzjheaq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ubwfzjheaq .gt_indent_1 {
  text-indent: 5px;
}

#ubwfzjheaq .gt_indent_2 {
  text-indent: 10px;
}

#ubwfzjheaq .gt_indent_3 {
  text-indent: 15px;
}

#ubwfzjheaq .gt_indent_4 {
  text-indent: 20px;
}

#ubwfzjheaq .gt_indent_5 {
  text-indent: 25px;
}

#ubwfzjheaq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ubwfzjheaq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Linear Model Summary</th>
</tr>
<tr class="gt_col_headings even">
<th id="r.squared" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">r.squared</th>
<th id="adj.r.squared" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">adj.r.squared</th>
<th id="sigma" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sigma</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">statistic</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p.value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="r.squared">0.9555</td>
<td class="gt_row gt_right" headers="adj.r.squared">0.9527</td>
<td class="gt_row gt_right" headers="sigma">0.0626</td>
<td class="gt_row gt_right" headers="statistic">340.5155</td>
<td class="gt_row gt_right" headers="p.value">2.283065e-151</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Commentary:</strong> Compare coefficient significance for internal vs macro features. Do consumer sentiment or SPY returns help predict card market movements?</p>
</section>
<section id="decision-tree" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="decision-tree"><span class="header-section-number">4.7.2</span> Decision Tree</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model_cart <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">decision_tree</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(return_next <span class="sc">~</span> ., <span class="at">data =</span> train_baked)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  model_cart<span class="sc">$</span>fit,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">roundint =</span> <span class="cn">FALSE</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">fallen.leaves =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">extra =</span> <span class="st">"auto"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Decision Tree: With Macro Factors"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">box.palette =</span> <span class="st">"Blues"</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/model-cart-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Commentary:</strong> The decision tree provides interpretable splits. Variables at the top are most important. Terminal nodes show predicted returns for different “market regimes.”</p>
</section>
</section>
<section id="step-7-model-evaluation-with-yardstick" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="step-7-model-evaluation-with-yardstick"><span class="header-section-number">4.8</span> Step 7: Model Evaluation with yardstick</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model predictions</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lm_pred <span class="ot">&lt;-</span> model_lm <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(<span class="at">new_data =</span> test_baked) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> test_baked<span class="sc">$</span>return_next)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision tree predictions  </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>cart_pred <span class="ot">&lt;-</span> model_cart <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(<span class="at">new_data =</span> test_baked) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> test_baked<span class="sc">$</span>return_next)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Metrics using yardstick (from class notes)</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Linear Regression: Out-of-Sample Performance ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>=== Linear Regression: Out-of-Sample Performance ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lm_metrics <span class="ot">&lt;-</span> lm_pred <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> truth, <span class="at">estimate =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(.metric)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lm_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 mae     standard       0.141
2 rmse    standard       0.212
3 rsq     standard       0.382</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Decision Tree: Out-of-Sample Performance ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Decision Tree: Out-of-Sample Performance ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cart_metrics <span class="ot">&lt;-</span> cart_pred <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> truth, <span class="at">estimate =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(.metric)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cart_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 mae     standard       0.145
2 rmse    standard       0.215
3 rsq     standard       0.434</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Side-by-side comparison</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  lm_metrics <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Linear Regression"</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  cart_metrics <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Decision Tree"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> .estimate) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model, rmse, rsq, mae) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(rmse, mae), <span class="at">decimals =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> rsq, <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Comparison: Out-of-Sample Performance"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE/MAE is better; Higher R² is better"</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="admfvlgler" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#admfvlgler table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#admfvlgler thead, #admfvlgler tbody, #admfvlgler tfoot, #admfvlgler tr, #admfvlgler td, #admfvlgler th {
  border-style: none;
}

#admfvlgler p {
  margin: 0;
  padding: 0;
}

#admfvlgler .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#admfvlgler .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#admfvlgler .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#admfvlgler .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#admfvlgler .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#admfvlgler .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#admfvlgler .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#admfvlgler .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#admfvlgler .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#admfvlgler .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#admfvlgler .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#admfvlgler .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#admfvlgler .gt_spanner_row {
  border-bottom-style: hidden;
}

#admfvlgler .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#admfvlgler .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#admfvlgler .gt_from_md > :first-child {
  margin-top: 0;
}

#admfvlgler .gt_from_md > :last-child {
  margin-bottom: 0;
}

#admfvlgler .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#admfvlgler .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#admfvlgler .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#admfvlgler .gt_row_group_first td {
  border-top-width: 2px;
}

#admfvlgler .gt_row_group_first th {
  border-top-width: 2px;
}

#admfvlgler .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#admfvlgler .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#admfvlgler .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#admfvlgler .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#admfvlgler .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#admfvlgler .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#admfvlgler .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#admfvlgler .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#admfvlgler .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#admfvlgler .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#admfvlgler .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#admfvlgler .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#admfvlgler .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#admfvlgler .gt_left {
  text-align: left;
}

#admfvlgler .gt_center {
  text-align: center;
}

#admfvlgler .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#admfvlgler .gt_font_normal {
  font-weight: normal;
}

#admfvlgler .gt_font_bold {
  font-weight: bold;
}

#admfvlgler .gt_font_italic {
  font-style: italic;
}

#admfvlgler .gt_super {
  font-size: 65%;
}

#admfvlgler .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#admfvlgler .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#admfvlgler .gt_indent_1 {
  text-indent: 5px;
}

#admfvlgler .gt_indent_2 {
  text-indent: 10px;
}

#admfvlgler .gt_indent_3 {
  text-indent: 15px;
}

#admfvlgler .gt_indent_4 {
  text-indent: 20px;
}

#admfvlgler .gt_indent_5 {
  text-indent: 25px;
}

#admfvlgler .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#admfvlgler div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Model Comparison: Out-of-Sample Performance</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Lower RMSE/MAE is better; Higher R² is better</th>
</tr>
<tr class="gt_col_headings header">
<th id="model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model</th>
<th id="rmse" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rmse</th>
<th id="rsq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rsq</th>
<th id="mae" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mae</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="model">Linear Regression</td>
<td class="gt_row gt_right" headers="rmse">0.21192</td>
<td class="gt_row gt_right" headers="rsq">38.25%</td>
<td class="gt_row gt_right" headers="mae">0.14098</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model">Decision Tree</td>
<td class="gt_row gt_right" headers="rmse">0.21461</td>
<td class="gt_row gt_right" headers="rsq">43.38%</td>
<td class="gt_row gt_right" headers="mae">0.14494</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="directional-accuracy" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="directional-accuracy"><span class="header-section-number">4.9</span> Directional Accuracy</h2>
<p>In trading, predicting the <em>direction</em> (up/down) matters as much as magnitude.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>direction_results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  lm_pred <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Linear Regression"</span>),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  cart_pred <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Decision Tree"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction_accuracy =</span> <span class="fu">mean</span>(<span class="fu">sign</span>(.pred) <span class="sc">==</span> <span class="fu">sign</span>(truth), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_correct =</span> <span class="fu">sum</span>(<span class="fu">sign</span>(.pred) <span class="sc">==</span> <span class="fu">sign</span>(truth), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total =</span> <span class="fu">n</span>(),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>direction_results <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> direction_accuracy, <span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Directional Accuracy"</span>,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Can we predict whether tomorrow is UP or DOWN?"</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> direction_accuracy, <span class="at">palette =</span> <span class="st">"Greens"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="gmzvbcaotk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gmzvbcaotk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gmzvbcaotk thead, #gmzvbcaotk tbody, #gmzvbcaotk tfoot, #gmzvbcaotk tr, #gmzvbcaotk td, #gmzvbcaotk th {
  border-style: none;
}

#gmzvbcaotk p {
  margin: 0;
  padding: 0;
}

#gmzvbcaotk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gmzvbcaotk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gmzvbcaotk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gmzvbcaotk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gmzvbcaotk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gmzvbcaotk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmzvbcaotk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gmzvbcaotk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gmzvbcaotk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gmzvbcaotk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gmzvbcaotk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gmzvbcaotk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gmzvbcaotk .gt_spanner_row {
  border-bottom-style: hidden;
}

#gmzvbcaotk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gmzvbcaotk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gmzvbcaotk .gt_from_md > :first-child {
  margin-top: 0;
}

#gmzvbcaotk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gmzvbcaotk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gmzvbcaotk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gmzvbcaotk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gmzvbcaotk .gt_row_group_first td {
  border-top-width: 2px;
}

#gmzvbcaotk .gt_row_group_first th {
  border-top-width: 2px;
}

#gmzvbcaotk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmzvbcaotk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gmzvbcaotk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gmzvbcaotk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmzvbcaotk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmzvbcaotk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gmzvbcaotk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gmzvbcaotk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gmzvbcaotk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmzvbcaotk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gmzvbcaotk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmzvbcaotk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gmzvbcaotk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmzvbcaotk .gt_left {
  text-align: left;
}

#gmzvbcaotk .gt_center {
  text-align: center;
}

#gmzvbcaotk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gmzvbcaotk .gt_font_normal {
  font-weight: normal;
}

#gmzvbcaotk .gt_font_bold {
  font-weight: bold;
}

#gmzvbcaotk .gt_font_italic {
  font-style: italic;
}

#gmzvbcaotk .gt_super {
  font-size: 65%;
}

#gmzvbcaotk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gmzvbcaotk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gmzvbcaotk .gt_indent_1 {
  text-indent: 5px;
}

#gmzvbcaotk .gt_indent_2 {
  text-indent: 10px;
}

#gmzvbcaotk .gt_indent_3 {
  text-indent: 15px;
}

#gmzvbcaotk .gt_indent_4 {
  text-indent: 20px;
}

#gmzvbcaotk .gt_indent_5 {
  text-indent: 25px;
}

#gmzvbcaotk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gmzvbcaotk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Directional Accuracy</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Can we predict whether tomorrow is UP or DOWN?</th>
</tr>
<tr class="gt_col_headings header">
<th id="model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model</th>
<th id="direction_accuracy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">direction_accuracy</th>
<th id="n_correct" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_correct</th>
<th id="n_total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="model">Decision Tree</td>
<td class="gt_row gt_right" headers="direction_accuracy" style="background-color: #74C476; color: #000000">100.0%</td>
<td class="gt_row gt_right" headers="n_correct">110</td>
<td class="gt_row gt_right" headers="n_total">110</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model">Linear Regression</td>
<td class="gt_row gt_right" headers="direction_accuracy" style="background-color: #74C476; color: #000000">100.0%</td>
<td class="gt_row gt_right" headers="n_correct">110</td>
<td class="gt_row gt_right" headers="n_total">110</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Commentary:</strong> Direction accuracy &gt; 50% suggests meaningful predictive power beyond random guessing. Even 55% accuracy can be valuable in low-transaction-cost environments.</p>
</section>
<section id="predicted-vs.-actual-visualization" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="predicted-vs.-actual-visualization"><span class="header-section-number">4.10</span> Predicted vs.&nbsp;Actual Visualization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  lm_pred <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Linear Regression"</span>),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  cart_pred <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"Decision Tree"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> truth)) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>model) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted vs. Actual Returns (Test Set)"</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Dashed red = perfect prediction; Blue = actual fit"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted Return"</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Actual Return"</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/pred-vs-actual-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-diagnostics" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="residual-diagnostics"><span class="header-section-number">4.11</span> Residual Diagnostics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check residuals for linear model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lm_residuals <span class="ot">&lt;-</span> test_baked<span class="sc">$</span>return_next <span class="sc">-</span> <span class="fu">predict</span>(model_lm, test_baked)<span class="sc">$</span>.pred</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(lm_residuals, <span class="at">main =</span> <span class="st">"Residual ACF: Linear Model"</span>, <span class="at">na.action =</span> na.pass)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lm_residuals, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Residual Distribution"</span>, </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/residual-diagnostics-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Commentary:</strong> - <strong>Residual ACF</strong>: No significant spikes = model captured temporal structure - <strong>Residual distribution</strong>: Should be symmetric and centered at zero</p>
<hr>
</section>
</section>
<section id="part-3-card-level-risk-analysis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Part 3: Card-Level Risk Analysis</h1>
<p><strong>Beyond the basket:</strong> Individual cards have vastly different risk profiles. What drives these differences?</p>
<section id="calculate-card-level-risk-metrics" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="calculate-card-level-risk-metrics"><span class="header-section-number">5.1</span> Calculate Card-Level Risk Metrics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get basket returns for beta calculation</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>basket_daily <span class="ot">&lt;-</span> basket_index <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, basket_return)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics for each card</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>card_metrics <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(basket_daily, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(card_id, card_name, rarity) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_return =</span> <span class="fu">mean</span>(daily_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">252</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">volatility =</span> <span class="fu">sd</span>(daily_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ann_volatility =</span> <span class="fu">sd</span>(daily_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_price =</span> <span class="fu">mean</span>(Price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_volume =</span> <span class="fu">mean</span>(Volume, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beta to basket</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fu">cov</span>(daily_return, basket_return, <span class="at">use =</span> <span class="st">"complete.obs"</span>) <span class="sc">/</span> </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>           <span class="fu">var</span>(basket_return, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">rarity_numeric =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Common"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Uncommon"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Rare"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Holo Rare"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Promo"</span> <span class="sc">~</span> <span class="fl">4.5</span>,</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Ultra Rare"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Secret Rare"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>      rarity <span class="sc">==</span> <span class="st">"Double Rare"</span> <span class="sc">~</span> <span class="fl">5.5</span>,</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sharpe =</span> mean_return <span class="sc">/</span> ann_volatility</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>card_metrics <span class="sc">%&gt;%</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ann_volatility)) <span class="sc">%&gt;%</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(card_name, rarity, ann_volatility, beta, avg_price) <span class="sc">%&gt;%</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> ann_volatility, <span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> beta, <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(<span class="at">columns =</span> avg_price, <span class="at">currency =</span> <span class="st">"USD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Most Volatile Cards"</span>, <span class="at">subtitle =</span> <span class="st">"Ranked by annualized volatility"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ivjgsrylji" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ivjgsrylji table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ivjgsrylji thead, #ivjgsrylji tbody, #ivjgsrylji tfoot, #ivjgsrylji tr, #ivjgsrylji td, #ivjgsrylji th {
  border-style: none;
}

#ivjgsrylji p {
  margin: 0;
  padding: 0;
}

#ivjgsrylji .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ivjgsrylji .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ivjgsrylji .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ivjgsrylji .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ivjgsrylji .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivjgsrylji .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjgsrylji .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivjgsrylji .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ivjgsrylji .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ivjgsrylji .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ivjgsrylji .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ivjgsrylji .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ivjgsrylji .gt_spanner_row {
  border-bottom-style: hidden;
}

#ivjgsrylji .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ivjgsrylji .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ivjgsrylji .gt_from_md > :first-child {
  margin-top: 0;
}

#ivjgsrylji .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ivjgsrylji .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ivjgsrylji .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjgsrylji .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ivjgsrylji .gt_row_group_first td {
  border-top-width: 2px;
}

#ivjgsrylji .gt_row_group_first th {
  border-top-width: 2px;
}

#ivjgsrylji .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjgsrylji .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ivjgsrylji .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ivjgsrylji .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjgsrylji .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjgsrylji .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ivjgsrylji .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ivjgsrylji .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ivjgsrylji .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjgsrylji .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivjgsrylji .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjgsrylji .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivjgsrylji .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjgsrylji .gt_left {
  text-align: left;
}

#ivjgsrylji .gt_center {
  text-align: center;
}

#ivjgsrylji .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ivjgsrylji .gt_font_normal {
  font-weight: normal;
}

#ivjgsrylji .gt_font_bold {
  font-weight: bold;
}

#ivjgsrylji .gt_font_italic {
  font-style: italic;
}

#ivjgsrylji .gt_super {
  font-size: 65%;
}

#ivjgsrylji .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ivjgsrylji .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ivjgsrylji .gt_indent_1 {
  text-indent: 5px;
}

#ivjgsrylji .gt_indent_2 {
  text-indent: 10px;
}

#ivjgsrylji .gt_indent_3 {
  text-indent: 15px;
}

#ivjgsrylji .gt_indent_4 {
  text-indent: 20px;
}

#ivjgsrylji .gt_indent_5 {
  text-indent: 25px;
}

#ivjgsrylji .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ivjgsrylji div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal">Most Volatile Cards</th>
</tr>
<tr class="gt_heading even">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Ranked by annualized volatility</th>
</tr>
<tr class="gt_col_headings header">
<th id="card_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">card_name</th>
<th id="rarity" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">rarity</th>
<th id="ann_volatility" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ann_volatility</th>
<th id="beta" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">beta</th>
<th id="avg_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_price</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Squirtle - 064/100</td>
<td class="gt_row gt_left" headers="rarity">Common</td>
<td class="gt_row gt_right" headers="ann_volatility">78,656.1%</td>
<td class="gt_row gt_right" headers="beta">25.98</td>
<td class="gt_row gt_right" headers="avg_price">$36.82</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Mewtwo</td>
<td class="gt_row gt_left" headers="rarity">Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">22,090.8%</td>
<td class="gt_row gt_right" headers="beta">3.95</td>
<td class="gt_row gt_right" headers="avg_price">$208.53</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Pikachu</td>
<td class="gt_row gt_left" headers="rarity">Common</td>
<td class="gt_row gt_right" headers="ann_volatility">13,287.3%</td>
<td class="gt_row gt_right" headers="beta">0.14</td>
<td class="gt_row gt_right" headers="avg_price">$65.21</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Venusaur</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">11,668.8%</td>
<td class="gt_row gt_right" headers="beta">1.32</td>
<td class="gt_row gt_right" headers="avg_price">$202.54</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Tyranitar - XY130 (Prerelease) [Staff]</td>
<td class="gt_row gt_left" headers="rarity">Promo</td>
<td class="gt_row gt_right" headers="ann_volatility">11,524.8%</td>
<td class="gt_row gt_right" headers="beta">−0.93</td>
<td class="gt_row gt_right" headers="avg_price">$90.99</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Lapras</td>
<td class="gt_row gt_left" headers="rarity">Common</td>
<td class="gt_row gt_right" headers="ann_volatility">7,069.9%</td>
<td class="gt_row gt_right" headers="beta">0.91</td>
<td class="gt_row gt_right" headers="avg_price">$57.34</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Charizard</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">6,195.1%</td>
<td class="gt_row gt_right" headers="beta">0.04</td>
<td class="gt_row gt_right" headers="avg_price">$1,945.05</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Zapdos (15)</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">6,157.2%</td>
<td class="gt_row gt_right" headers="beta">0.01</td>
<td class="gt_row gt_right" headers="avg_price">$48.16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Shining Tyranitar</td>
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">3,948.8%</td>
<td class="gt_row gt_right" headers="beta">0.03</td>
<td class="gt_row gt_right" headers="avg_price">$713.51</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Shining Mewtwo</td>
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">3,935.4%</td>
<td class="gt_row gt_right" headers="beta">0.04</td>
<td class="gt_row gt_right" headers="avg_price">$589.95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="card_name">Lugia</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">3,833.0%</td>
<td class="gt_row gt_right" headers="beta">0.00</td>
<td class="gt_row gt_right" headers="avg_price">$726.67</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="card_name">Tyranitar (H28)</td>
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="ann_volatility">3,761.6%</td>
<td class="gt_row gt_right" headers="beta">0.69</td>
<td class="gt_row gt_right" headers="avg_price">$279.05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="volatility-by-rarity" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="volatility-by-rarity"><span class="header-section-number">5.2</span> Volatility by Rarity</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(card_metrics, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(rarity, rarity_numeric), <span class="at">y =</span> ann_volatility)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rarity), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Card Volatility by Rarity Tier"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Do rarer cards exhibit more price volatility?"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Rarity"</span>, <span class="at">y =</span> <span class="st">"Annualized Volatility"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/vol-by-rarity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ml-approach-what-drives-card-volatility" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="ml-approach-what-drives-card-volatility"><span class="header-section-number">5.3</span> ML Approach: What Drives Card Volatility?</h2>
<p>We apply the same tidymodels workflow to model card-level volatility.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>vol_data <span class="ot">&lt;-</span> card_metrics <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ann_volatility, rarity_numeric, avg_price, avg_volume) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_price =</span> <span class="fu">log</span>(avg_price <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_volume =</span> <span class="fu">log</span>(avg_volume <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling (random split OK for cross-sectional data)</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>vol_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(vol_data, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>vol_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(vol_split)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>vol_test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(vol_split)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Volatility model - Training:"</span>, <span class="fu">nrow</span>(vol_train), <span class="st">"| Testing:"</span>, <span class="fu">nrow</span>(vol_test), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Volatility model - Training: 31 | Testing: 8 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recipe</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>vol_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  ann_volatility <span class="sc">~</span> rarity_numeric <span class="sc">+</span> log_price <span class="sc">+</span> log_volume,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> vol_train</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">prep</span>()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>vol_train_baked <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">bake</span>(vol_recipe, vol_train)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>vol_test_baked <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">bake</span>(vol_recipe, vol_test)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>vol_model_lm <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(ann_volatility <span class="sc">~</span> ., <span class="at">data =</span> vol_train_baked)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Volatility Model Coefficients ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Volatility Model Coefficients ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>parsnip<span class="sc">::</span><span class="fu">tidy</span>(vol_model_lm) <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xkfenjoaij" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xkfenjoaij table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xkfenjoaij thead, #xkfenjoaij tbody, #xkfenjoaij tfoot, #xkfenjoaij tr, #xkfenjoaij td, #xkfenjoaij th {
  border-style: none;
}

#xkfenjoaij p {
  margin: 0;
  padding: 0;
}

#xkfenjoaij .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xkfenjoaij .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xkfenjoaij .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xkfenjoaij .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xkfenjoaij .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkfenjoaij .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkfenjoaij .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkfenjoaij .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xkfenjoaij .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xkfenjoaij .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xkfenjoaij .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xkfenjoaij .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xkfenjoaij .gt_spanner_row {
  border-bottom-style: hidden;
}

#xkfenjoaij .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xkfenjoaij .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xkfenjoaij .gt_from_md > :first-child {
  margin-top: 0;
}

#xkfenjoaij .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xkfenjoaij .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xkfenjoaij .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xkfenjoaij .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xkfenjoaij .gt_row_group_first td {
  border-top-width: 2px;
}

#xkfenjoaij .gt_row_group_first th {
  border-top-width: 2px;
}

#xkfenjoaij .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkfenjoaij .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xkfenjoaij .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xkfenjoaij .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkfenjoaij .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkfenjoaij .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xkfenjoaij .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xkfenjoaij .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xkfenjoaij .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkfenjoaij .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkfenjoaij .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkfenjoaij .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkfenjoaij .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkfenjoaij .gt_left {
  text-align: left;
}

#xkfenjoaij .gt_center {
  text-align: center;
}

#xkfenjoaij .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xkfenjoaij .gt_font_normal {
  font-weight: normal;
}

#xkfenjoaij .gt_font_bold {
  font-weight: bold;
}

#xkfenjoaij .gt_font_italic {
  font-style: italic;
}

#xkfenjoaij .gt_super {
  font-size: 65%;
}

#xkfenjoaij .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xkfenjoaij .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xkfenjoaij .gt_indent_1 {
  text-indent: 5px;
}

#xkfenjoaij .gt_indent_2 {
  text-indent: 10px;
}

#xkfenjoaij .gt_indent_3 {
  text-indent: 15px;
}

#xkfenjoaij .gt_indent_4 {
  text-indent: 20px;
}

#xkfenjoaij .gt_indent_5 {
  text-indent: 25px;
}

#xkfenjoaij .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xkfenjoaij div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">std.error</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">statistic</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p.value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">(Intercept)</td>
<td class="gt_row gt_right" headers="estimate">55.6047</td>
<td class="gt_row gt_right" headers="std.error">22.5727</td>
<td class="gt_row gt_right" headers="statistic">2.4634</td>
<td class="gt_row gt_right" headers="p.value">0.0204</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">rarity_numeric</td>
<td class="gt_row gt_right" headers="estimate">-71.6764</td>
<td class="gt_row gt_right" headers="std.error">24.6519</td>
<td class="gt_row gt_right" headers="statistic">-2.9075</td>
<td class="gt_row gt_right" headers="p.value">0.0072</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">log_price</td>
<td class="gt_row gt_right" headers="estimate">-19.1425</td>
<td class="gt_row gt_right" headers="std.error">33.0982</td>
<td class="gt_row gt_right" headers="statistic">-0.5784</td>
<td class="gt_row gt_right" headers="p.value">0.5678</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">log_volume</td>
<td class="gt_row gt_right" headers="estimate">-17.7778</td>
<td class="gt_row gt_right" headers="std.error">34.3512</td>
<td class="gt_row gt_right" headers="statistic">-0.5175</td>
<td class="gt_row gt_right" headers="p.value">0.6090</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test set performance</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Out-of-Sample Performance ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Out-of-Sample Performance ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>vol_model_lm <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(<span class="at">new_data =</span> vol_test_baked) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> vol_test_baked<span class="sc">$</span>ann_volatility) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> truth, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard      64.5  
2 rsq     standard       0.453
3 mae     standard      58.4  </code></pre>
</div>
</div>
</section>
<section id="decision-tree-volatility-segmentation" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="decision-tree-volatility-segmentation"><span class="header-section-number">5.4</span> Decision Tree: Volatility Segmentation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>vol_tree <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">decision_tree</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(ann_volatility <span class="sc">~</span> rarity_numeric <span class="sc">+</span> avg_price <span class="sc">+</span> avg_volume, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> card_metrics <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>())</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  vol_tree<span class="sc">$</span>fit,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">roundint =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.9</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fallen.leaves =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">extra =</span> <span class="st">"auto"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"What Drives Card Volatility?"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">box.palette =</span> <span class="st">"Blue"</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dasda_files/figure-html/vol-tree-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Commentary:</strong> The decision tree segments cards into risk buckets. The first split identifies the most important volatility driver. Terminal nodes show average volatility for each segment—useful for categorizing new cards.</p>
</section>
<section id="summary-by-rarity" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="summary-by-rarity"><span class="header-section-number">5.5</span> Summary by Rarity</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>card_metrics <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rarity) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_cards =</span> <span class="fu">n</span>(),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_volatility =</span> <span class="fu">mean</span>(ann_volatility, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_beta =</span> <span class="fu">mean</span>(beta, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_price =</span> <span class="fu">mean</span>(avg_price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_sharpe =</span> <span class="fu">mean</span>(sharpe, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_volatility)) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> avg_volatility, <span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(avg_beta, avg_sharpe), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(<span class="at">columns =</span> avg_price, <span class="at">currency =</span> <span class="st">"USD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Risk-Return Profile by Rarity"</span>,</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Which rarity tiers offer best risk-adjusted returns?"</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yoqfwsjmfa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yoqfwsjmfa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yoqfwsjmfa thead, #yoqfwsjmfa tbody, #yoqfwsjmfa tfoot, #yoqfwsjmfa tr, #yoqfwsjmfa td, #yoqfwsjmfa th {
  border-style: none;
}

#yoqfwsjmfa p {
  margin: 0;
  padding: 0;
}

#yoqfwsjmfa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yoqfwsjmfa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yoqfwsjmfa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yoqfwsjmfa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yoqfwsjmfa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yoqfwsjmfa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoqfwsjmfa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yoqfwsjmfa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yoqfwsjmfa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yoqfwsjmfa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yoqfwsjmfa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yoqfwsjmfa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yoqfwsjmfa .gt_spanner_row {
  border-bottom-style: hidden;
}

#yoqfwsjmfa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yoqfwsjmfa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yoqfwsjmfa .gt_from_md > :first-child {
  margin-top: 0;
}

#yoqfwsjmfa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yoqfwsjmfa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yoqfwsjmfa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yoqfwsjmfa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yoqfwsjmfa .gt_row_group_first td {
  border-top-width: 2px;
}

#yoqfwsjmfa .gt_row_group_first th {
  border-top-width: 2px;
}

#yoqfwsjmfa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoqfwsjmfa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yoqfwsjmfa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yoqfwsjmfa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoqfwsjmfa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoqfwsjmfa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yoqfwsjmfa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yoqfwsjmfa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yoqfwsjmfa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoqfwsjmfa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yoqfwsjmfa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoqfwsjmfa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yoqfwsjmfa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoqfwsjmfa .gt_left {
  text-align: left;
}

#yoqfwsjmfa .gt_center {
  text-align: center;
}

#yoqfwsjmfa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yoqfwsjmfa .gt_font_normal {
  font-weight: normal;
}

#yoqfwsjmfa .gt_font_bold {
  font-weight: bold;
}

#yoqfwsjmfa .gt_font_italic {
  font-style: italic;
}

#yoqfwsjmfa .gt_super {
  font-size: 65%;
}

#yoqfwsjmfa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yoqfwsjmfa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yoqfwsjmfa .gt_indent_1 {
  text-indent: 5px;
}

#yoqfwsjmfa .gt_indent_2 {
  text-indent: 10px;
}

#yoqfwsjmfa .gt_indent_3 {
  text-indent: 15px;
}

#yoqfwsjmfa .gt_indent_4 {
  text-indent: 20px;
}

#yoqfwsjmfa .gt_indent_5 {
  text-indent: 25px;
}

#yoqfwsjmfa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yoqfwsjmfa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="6" class="gt_heading gt_title gt_font_normal">Risk-Return Profile by Rarity</th>
</tr>
<tr class="gt_heading even">
<th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Which rarity tiers offer best risk-adjusted returns?</th>
</tr>
<tr class="gt_col_headings header">
<th id="rarity" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">rarity</th>
<th id="n_cards" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_cards</th>
<th id="avg_volatility" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_volatility</th>
<th id="avg_beta" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_beta</th>
<th id="avg_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_price</th>
<th id="avg_sharpe" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_sharpe</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="rarity">Common</td>
<td class="gt_row gt_right" headers="n_cards">4</td>
<td class="gt_row gt_right" headers="avg_volatility">24,956.3%</td>
<td class="gt_row gt_right" headers="avg_beta">6.76</td>
<td class="gt_row gt_right" headers="avg_price">$57.08</td>
<td class="gt_row gt_right" headers="avg_sharpe">6.94</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="rarity">Rare</td>
<td class="gt_row gt_right" headers="n_cards">1</td>
<td class="gt_row gt_right" headers="avg_volatility">22,090.8%</td>
<td class="gt_row gt_right" headers="avg_beta">3.95</td>
<td class="gt_row gt_right" headers="avg_price">$208.53</td>
<td class="gt_row gt_right" headers="avg_sharpe">7.13</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="rarity">Promo</td>
<td class="gt_row gt_right" headers="n_cards">3</td>
<td class="gt_row gt_right" headers="avg_volatility">4,701.3%</td>
<td class="gt_row gt_right" headers="avg_beta">−0.14</td>
<td class="gt_row gt_right" headers="avg_price">$137.38</td>
<td class="gt_row gt_right" headers="avg_sharpe">4.30</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="rarity">Holo Rare</td>
<td class="gt_row gt_right" headers="n_cards">13</td>
<td class="gt_row gt_right" headers="avg_volatility">3,375.0%</td>
<td class="gt_row gt_right" headers="avg_beta">0.14</td>
<td class="gt_row gt_right" headers="avg_price">$369.16</td>
<td class="gt_row gt_right" headers="avg_sharpe">6.36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="rarity">Secret Rare</td>
<td class="gt_row gt_right" headers="n_cards">7</td>
<td class="gt_row gt_right" headers="avg_volatility">1,900.2%</td>
<td class="gt_row gt_right" headers="avg_beta">0.01</td>
<td class="gt_row gt_right" headers="avg_price">$378.93</td>
<td class="gt_row gt_right" headers="avg_sharpe">4.72</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="rarity">Ultra Rare</td>
<td class="gt_row gt_right" headers="n_cards">10</td>
<td class="gt_row gt_right" headers="avg_volatility">1,482.9%</td>
<td class="gt_row gt_right" headers="avg_beta">0.08</td>
<td class="gt_row gt_right" headers="avg_price">$383.97</td>
<td class="gt_row gt_right" headers="avg_sharpe">4.69</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="rarity">Double Rare</td>
<td class="gt_row gt_right" headers="n_cards">1</td>
<td class="gt_row gt_right" headers="avg_volatility">922.2%</td>
<td class="gt_row gt_right" headers="avg_beta">0.17</td>
<td class="gt_row gt_right" headers="avg_price">$3.71</td>
<td class="gt_row gt_right" headers="avg_sharpe">3.35</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="conclusions-key-findings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Conclusions &amp; Key Findings</h1>
<section id="summary-of-results" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="summary-of-results"><span class="header-section-number">6.1</span> Summary of Results</h2>
<section id="index-behavior" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="index-behavior"><span class="header-section-number">6.1.1</span> 1. Index Behavior</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fat Tails (Kurtosis):"</span>, <span class="fu">round</span>(e1071<span class="sc">::</span><span class="fu">kurtosis</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>), </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(e1071<span class="sc">::</span><span class="fu">kurtosis</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">"→ YES</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"→ NO</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fat Tails (Kurtosis): -0.32 → NO</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Skewness:"</span>, <span class="fu">round</span>(e1071<span class="sc">::</span><span class="fu">skewness</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(e1071<span class="sc">::</span><span class="fu">skewness</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"→ Crash-prone</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"→ Rally-prone</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness: 0.16 → Rally-prone</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Annualized Volatility:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(returns, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">252</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Annualized Volatility: 496.8 %</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> The basket exhibits <em>some</em> market-like properties (fat tails) but diverges in others. This reflects the unique nature of collectibles—illiquid, sentiment-driven, different information flows than equities.</p>
</section>
<section id="predictability-ml-results" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="predictability-ml-results"><span class="header-section-number">6.1.2</span> 2. Predictability (ML Results)</h3>
<p>The tidymodels workflow revealed:</p>
<ul>
<li><strong>Best predictors</strong> from recursive screening: [See univariate results above]</li>
<li><strong>Linear model vs Decision Tree</strong>: Compare RMSE, R², direction accuracy</li>
<li><strong>VIF analysis</strong>: Identified multicollinearity issues with rolling features</li>
</ul>
</section>
<section id="risk-factors" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="risk-factors"><span class="header-section-number">6.1.3</span> 3. Risk Factors</h3>
<p>Key volatility drivers from the ML analysis:</p>
<ul>
<li><strong>Rarity effect</strong>: [More/less volatile for rarer cards?]</li>
<li><strong>Price level effect</strong>: [Higher-priced cards more/less volatile?]</li>
<li><strong>Volume effect</strong>: [Does trading activity affect risk?]</li>
</ul>
</section>
</section>
<section id="limitations" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="limitations"><span class="header-section-number">6.2</span> Limitations</h2>
<ol type="1">
<li><strong>Interpolated prices</strong>: May underestimate true volatility</li>
<li><strong>Single condition</strong>: Near Mint only</li>
<li><strong>Limited history</strong>: ~1 year of data</li>
<li><strong>Survivorship bias</strong>: Only actively traded cards included</li>
<li><strong>Transaction costs</strong>: Not considered in predictability analysis</li>
</ol>
</section>
<section id="workflow-summary" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="workflow-summary"><span class="header-section-number">6.3</span> Workflow Summary</h2>
<p>The Tidymodels pipeline provides a systematic, reproducible approach:</p>
<pre><code>rsample::initial_time_split() → Train/Test split
       ↓
recipes::recipe() → Feature engineering
       ↓
parsnip::linear_reg() / decision_tree() → Model fitting
       ↓
yardstick::metrics() → Evaluation</code></pre>
<p>This same scaffolding can be applied to any financial prediction problem.</p>
<hr>
</section>
</section>
<section id="appendix-session-info" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Appendix: Session Info</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26100)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=English_Canada.utf8  LC_CTYPE=English_Canada.utf8   
[3] LC_MONETARY=English_Canada.utf8 LC_NUMERIC=C                   
[5] LC_TIME=English_Canada.utf8    

time zone: America/Edmonton
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gt_1.0.0           rpart.plot_3.1.3   rpart_4.1.24       zoo_1.8-14        
 [5] yardstick_1.3.2    workflowsets_1.1.1 workflows_1.3.0    tune_2.0.1        
 [9] tailor_0.1.0       rsample_1.3.1      recipes_1.3.1      parsnip_1.4.0     
[13] modeldata_1.5.1    infer_1.0.9        dials_1.4.2        scales_1.4.0      
[17] broom_1.0.10       tidymodels_1.4.1   lubridate_1.9.4    forcats_1.0.1     
[21] stringr_1.5.2      dplyr_1.1.4        purrr_1.1.0        readr_2.1.5       
[25] tidyr_1.3.1        tibble_3.3.0       ggplot2_4.0.0      tidyverse_2.0.0   

loaded via a namespace (and not attached):
 [1] rlang_1.1.6                magrittr_2.0.3            
 [3] furrr_0.3.1                e1071_1.7-16              
 [5] compiler_4.5.1             mgcv_1.9-3                
 [7] vctrs_0.6.5                lhs_1.2.0                 
 [9] quadprog_1.5-8             pkgconfig_2.0.3           
[11] fastmap_1.2.0              backports_1.5.0           
[13] labeling_0.4.3             utf8_1.2.6                
[15] rmarkdown_2.30             prodlim_2025.04.28        
[17] tzdb_0.5.0                 xfun_0.53                 
[19] jsonlite_2.0.0             parallel_4.5.1            
[21] R6_2.6.1                   stringi_1.8.7             
[23] RColorBrewer_1.1-3         parallelly_1.45.1         
[25] Rcpp_1.1.0                 knitr_1.50                
[27] future.apply_1.20.0        Matrix_1.7-3              
[29] splines_4.5.1              nnet_7.3-20               
[31] timechange_0.3.0           tidyselect_1.2.1          
[33] rstudioapi_0.17.1          yaml_2.3.10               
[35] timeDate_4041.110          codetools_0.2-20          
[37] curl_7.0.0                 listenv_0.9.1             
[39] lattice_0.22-7             quantmod_0.4.28           
[41] withr_3.0.2                S7_0.2.0                  
[43] evaluate_1.0.5             PerformanceAnalytics_2.0.8
[45] timetk_2.9.1               future_1.67.0             
[47] survival_3.8-3             proxy_0.4-27              
[49] xts_0.14.1                 xml2_1.4.0                
[51] pillar_1.11.1              generics_0.1.4            
[53] TTR_0.24.4                 hms_1.1.3                 
[55] globals_0.18.0             class_7.3-23              
[57] glue_1.8.0                 tools_4.5.1               
[59] data.table_1.17.8          gower_1.0.2               
[61] grid_4.5.1                 RobStatTM_1.0.11          
[63] ipred_0.9-15               nlme_3.1-168              
[65] cli_3.6.5                  DiceDesign_1.10           
[67] lava_1.8.1                 gtable_0.3.6              
[69] GPfit_1.0-9                sass_0.4.10               
[71] digest_0.6.37              htmlwidgets_1.6.4         
[73] farver_2.1.2               htmltools_0.5.8.1         
[75] lifecycle_1.0.4            hardhat_1.4.2             
[77] tidyquant_1.0.11           sparsevctrs_0.3.4         
[79] MASS_7.3-65               </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>